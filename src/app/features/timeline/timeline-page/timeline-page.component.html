<div class="timeline">
  <div class="timeline-right">
    <div class="status box">
      <div class="status-main">
        <a href="Profile.html"
          ><img
            src="https://res.cloudinary.com/dzqc5nfai/image/upload/v1743787413/tasiqt2dkqhjjmomflna.jpg"
            class="status-img"
        /></a>
        <input
          class="status-input"
          placeholder="What's on your mind?"
          (click)="openPostModal()"
        />
      </div>
      <div class="status-actions">
        <button class="status-action" (click)="openPostModal()">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
            <!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.-->
            <path
              d="M222.7 32.1c5 16.9-4.6 34.8-21.5 39.8C121.8 95.6 64 169.1 64 256c0 106 86 192 192 192s192-86 192-192c0-86.9-57.8-160.4-137.1-184.1c-16.9-5-26.6-22.9-21.5-39.8s22.9-26.6 39.8-21.5C434.9 42.1 512 140 512 256c0 141.4-114.6 256-256 256S0 397.4 0 256C0 140 77.1 42.1 182.9 10.6c16.9-5 34.8 4.6 39.8 21.5z"
            />
          </svg>
          Status
        </button>
        <button class="status-action" (click)="openPostModal()">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
            <!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.-->
            <path
              d="M160 32c-35.3 0-64 28.7-64 64l0 224c0 35.3 28.7 64 64 64l352 0c35.3 0 64-28.7 64-64l0-224c0-35.3-28.7-64-64-64L160 32zM396 138.7l96 144c4.9 7.4 5.4 16.8 1.2 24.6S480.9 320 472 320l-144 0-48 0-80 0c-9.2 0-17.6-5.3-21.6-13.6s-2.9-18.2 2.9-25.4l64-80c4.6-5.7 11.4-9 18.7-9s14.2 3.3 18.7 9l17.3 21.6 56-84C360.5 132 368 128 376 128s15.5 4 20 10.7zM192 128a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zM48 120c0-13.3-10.7-24-24-24S0 106.7 0 120L0 344c0 75.1 60.9 136 136 136l320 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-320 0c-48.6 0-88-39.4-88-88l0-224z"
            />
          </svg>
          Photos
        </button>
        <button class="status-action" (click)="openPostModal()">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
            <!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.-->
            <path
              d="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm177.6 62.1C192.8 334.5 218.8 352 256 352s63.2-17.5 78.4-33.9c9-9.7 24.2-10.4 33.9-1.4s10.4 24.2 1.4 33.9c-22 23.8-60 49.4-113.6 49.4s-91.7-25.5-113.6-49.4c-9-9.7-8.4-24.9 1.4-33.9s24.9-8.4 33.9 1.4zM144.4 208a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zm192-32a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"
            />
          </svg>
          Feeling
        </button>
      </div>
    </div>

    <div class="box">
      <div class="stories-container">
        <div class="stories-scroll">
          <!-- Stories will be added here by JavaScript -->
        </div>
      </div>
      <input type="file" id="storyFileInput" accept="image/*" multiple hidden />
    </div>

    @for (post of posts(); track post.id) {
    <div class="album box">
      <div class="status-main">
        <img [src]="post.author.avatar" class="status-img profile-pic" />
        <div class="album-detail">
          <div class="album-title">
            <strong>{{ post.author.name }}</strong>
            @if (post.feeling) {
            <span class="post-tag feeling-tag">
              {{ post.feeling.emoji }} {{ post.feeling.label }}
            </span>
            } @if (post.status) {
            <span class="post-tag status-tag">
              {{ post.status.emoji }} {{ post.status.label }}
            </span>
            }
          </div>
          <div class="album-date">{{ post.date }}</div>
        </div>
        <button class="intro-menu">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
            <path
              d="M0 48V487.7C0 501.1 10.9 512 24.3 512c5 0 9.9-1.5 14-4.4L192 400 345.7 507.6c4.1 2.9 9 4.4 14 4.4c13.4 0 24.3-10.9 24.3-24.3V48c0-26.5-21.5-48-48-48H48C21.5 0 0 21.5 0 48z"
            />
          </svg>
        </button>
      </div>
      <div class="album-content">
        <div class="album-text-wrapper">
          <div class="album-text" [attr.data-expanded]="post.isExpanded">
            {{ post.content }}
          </div>
          @if (shouldShowSeeMore(post.content) && !post.isExpanded) {
          <button class="see-more-btn" (click)="toggleExpand(post.id)">
            See More
          </button>
          }
        </div>

        @if (post.images && post.images.length > 0) {
        <div class="album-photos {{ getImageGridClass(post.images) }}">
          @for (image of post.images; track $index) {
          <img
            [src]="image"
            alt="Post image"
            class="album-photo"
            (click)="previewImage(image)"
          />
          }
        </div>
        }
      </div>
      <div class="album-actions">
        <button href="#" class="album-action-btn">
          <svg
            stroke="currentColor"
            stroke-width="2"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
            viewBox="0 0 24 24"
          >
            <path
              d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"
            />
          </svg>
          {{ post.likes }}
        </button>
        <button href="#" class="album-action-btn" (click)="openPostDetails(post.id)">
          <svg
            stroke="currentColor"
            stroke-width="2"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="css-i6dzq1"
            viewBox="0 0 24 24"
          >
            <path
              d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"
            />
          </svg>
          {{ post.comments }}
        </button>
        <button href="#" class="album-action-btn">
          <svg
            stroke="currentColor"
            stroke-width="2"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="css-i6dzq1"
            viewBox="0 0 24 24"
          >
            <path d="M17 1l4 4-4 4" />
            <path d="M3 11V9a4 4 0 014-4h14M7 23l-4-4 4-4" />
            <path d="M21 13v2a4 4 0 01-4 4H3" />
          </svg>
          {{ post.shares }}
        </button>
      </div>
    </div>
    }
  </div>
</div>

<app-add-post-modal />
<app-image-preview-modal />
<app-post-details-modal />
